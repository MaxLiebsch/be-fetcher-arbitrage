import { ObjectId } from "mongodb";
import { getCrawlDataDb } from "../db/mongo.js";
import { getShop } from "../db/util/shops.js";

const _ids = [
  "6680a418d63905fe5276bb6c",
  "6680a48cd63905fe5276d9a6",
  "66802438d63905fe526e8211",
  "6680a410d63905fe5276b80b",
  "668025c2d63905fe526ee481",
  "6680a480d63905fe5276d693",
  "6680a412d63905fe5276b855",
  "6680a427d63905fe5276bed7",
  "66802543d63905fe526ec0de",
  "6680a473d63905fe5276d45f",
  "6680a427d63905fe5276bedf",
  "6680a479d63905fe5276d5b7",
  "6680a42ed63905fe5276c12a",
  "6680a41cd63905fe5276bd17",
  "6680a450d63905fe5276cbd5",
  "6680a417d63905fe5276bb31",
  "6680a46ad63905fe5276d20c",
  "6680a427d63905fe5276befa",
  "6680a3cdd63905fe5276aacd",
  "6680a483d63905fe5276d832",
  "66802415d63905fe526e7d03",
  "6680a46bd63905fe5276d296",
  "66802432d63905fe526e80c6",
  "6680a48dd63905fe5276da07",
  "6680a417d63905fe5276bb26",
  "6680a41ad63905fe5276bc2a",
  "668025acd63905fe526edf96",
  "6680a48cd63905fe5276d9b3",
  "6680a427d63905fe5276bec9",
  "6680a410d63905fe5276b805",
  "6680a47fd63905fe5276d660",
  "6680a481d63905fe5276d6fb",
  "6680a410d63905fe5276b7e8",
  "6680a483d63905fe5276d81d",
  "6680a410d63905fe5276b816",
  "6680a41bd63905fe5276bccd",
  "66802437d63905fe526e81cf",
  "6680a42ed63905fe5276c0fa",
  "66802415d63905fe526e7cee",
  "6680253dd63905fe526ebf1c",
  "66802543d63905fe526ec0d0",
  "6680244bd63905fe526e8508",
  "6680242ad63905fe526e7fc3",
  "6680a450d63905fe5276cbc3",
  "6680a46ad63905fe5276d222",
  "6680a48cd63905fe5276d9cd",
  "6680a42dd63905fe5276c05c",
  "6680a46ad63905fe5276d1ff",
  "6680a469d63905fe5276d1e7",
  "6680a473d63905fe5276d424",
  "6680a47ad63905fe5276d5cf",
  "6680a47ad63905fe5276d5c8",
  "6680a416d63905fe5276ba12",
  "6680a48ed63905fe5276da18",
  "6680a451d63905fe5276cc14",
  "6680a44bd63905fe5276c8d4",
  "66802437d63905fe526e81f9",
  "66802415d63905fe526e7d19",
  "6680a417d63905fe5276bb03",
  "6680a400d63905fe5276b5c4",
  "6680a42dd63905fe5276c0bb",
  "6680a42ed63905fe5276c110",
  "668025c4d63905fe526ee544",
  "6680a47fd63905fe5276d634",
  "6680a46fd63905fe5276d379",
  "6680a479d63905fe5276d583",
  "6680a478d63905fe5276d516",
  "6680a47fd63905fe5276d64d",
  "6680a482d63905fe5276d7af",
  "6680a472d63905fe5276d3fb",
  "6680a42dd63905fe5276c077",
  "6680a473d63905fe5276d41e",
  "6680a48ed63905fe5276da24",
  "6680a42dd63905fe5276c0c2",
  "6680a41dd63905fe5276bd57",
  "6680a48cd63905fe5276d9ca",
  "6680a48dd63905fe5276da11",
  "6680a46cd63905fe5276d2bf",
  "6680a480d63905fe5276d683",
  "6680a3cad63905fe5276aa30",
  "6680a47ad63905fe5276d5c1",
  "6680a480d63905fe5276d675",
  "6680a46bd63905fe5276d28a",
  "6680a410d63905fe5276b7f0",
  "6680a3cad63905fe5276aa22",
  "6680a42ed63905fe5276c127",
  "6680a3cad63905fe5276a9e6",
  "66802415d63905fe526e7cfd",
  "6680a46cd63905fe5276d2a6",
  "6680a47fd63905fe5276d653",
  "6680a411d63905fe5276b821",
  "66802438d63905fe526e8214",
  "6680a40ed63905fe5276b785",
  "66802432d63905fe526e80d5",
  "6680a42ed63905fe5276c116",
  "6680a410d63905fe5276b7ed",
  "6680a472d63905fe5276d3fe",
  "6680a417d63905fe5276ba6f",
  "6680a3cad63905fe5276aa1f",
  "6680a482d63905fe5276d7a4",
  "6680a473d63905fe5276d446",
  "6680a42ed63905fe5276c135",
  "6680a47fd63905fe5276d656",
  "6680a481d63905fe5276d761",
  "66802432d63905fe526e808e",
  "6680a480d63905fe5276d695",
  "66802415d63905fe526e7cb6",
  "6680a473d63905fe5276d459",
  "6680a469d63905fe5276d1dd",
  "6680242bd63905fe526e7fd3",
  "66802431d63905fe526e8079",
  "6680a46ed63905fe5276d32e",
  "6680a415d63905fe5276b9a2",
  "6680a3cad63905fe5276aa2d",
  "6680a416d63905fe5276b9db",
  "6680a411d63905fe5276b81c",
  "66802413d63905fe526e7be8",
  "6680a48ed63905fe5276da46",
  "6680a477d63905fe5276d502",
  "6680a46bd63905fe5276d230",
  "6680a47fd63905fe5276d646",
  "66802415d63905fe526e7cc6",
  "66802431d63905fe526e8084",
  "6680a48ed63905fe5276da33",
  "6680a481d63905fe5276d794",
  "6680a46bd63905fe5276d235",
  "6680a472d63905fe5276d407",
  "6680a479d63905fe5276d593",
  "6680a46ad63905fe5276d210",
  "6680a479d63905fe5276d5b1",
  "6680a48dd63905fe5276d9d7",
  "66802432d63905fe526e80cf",
  "6680a46bd63905fe5276d260",
  "6680a472d63905fe5276d3ec",
  "6680253ed63905fe526ebf31",
  "66802434d63905fe526e8130",
  "6680a479d63905fe5276d5b4",
  "66802432d63905fe526e80a7",
  "66802438d63905fe526e820e",
  "668025c3d63905fe526ee510",
  "6680a46ad63905fe5276d1f7",
  "6680253cd63905fe526ebe28",
  "66802415d63905fe526e7cbe",
  "6680a42ed63905fe5276c100",
  "66802431d63905fe526e8081",
  "6680a46fd63905fe5276d36a",
  "66802438d63905fe526e81fc",
  "6680253dd63905fe526ebeb1",
];

const main = async () => {
  const shop = await getShop("alza.de");

  if (!shop) return "Shop not found";

  const db = await getCrawlDataDb();

  const collectionName = shop.d;
  const query = {
   
  };

  const update = {
    $set: {
      ean_prop: "",
      ean_locked: false,
      ean_taskId: ""
    },
  };

  return await db.collection(collectionName).updateMany(query, update);

};

main().then((r) => {
  console.log(r);
  process.exit(0);
});
